
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
      <meta name="description" content="Documentation for CALT library, a library for computational algebra using Transformers">
    
    
    
      <link rel="canonical" href="https://hiroshikera.github.io/calt/dataset_sympy/">
    
    
      <link rel="prev" href="../dataset_sagemath/">
    
    
      <link rel="next" href="../io_pipeline/">
    
    
    <link rel="icon" href="../assets/logo-light.png" sizes="any">
    <link rel="icon" href="../assets/logo-auto.svg" type="image/svg+xml">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">

    
      
        <title>SymPy backend - CALT library</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sympy-backend" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CALT library" class="md-header__button md-logo" aria-label="CALT library" data-md-component="logo">
      <!-- Logo -->
<img src="../assets/logo-light.svg" alt="logo" class="logo-light" />
<img src="../assets/logo-dark.svg" alt="logo" class="logo-dark" />
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CALT library
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SymPy backend
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/HiroshiKERA/calt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href=".." class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CALT library" class="md-nav__button md-logo" aria-label="CALT library" data-md-component="logo">
      <!-- Logo -->
<img src="../assets/logo-light.svg" alt="logo" class="logo-light" />
<img src="../assets/logo-dark.svg" alt="logo" class="logo-dark" />
    </a>
    CALT library
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/HiroshiKERA/calt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    CALT Components
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            CALT Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1_2_1" id="__nav_1_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Dataset pipeline
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            Dataset pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_sagemath/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SageMath backend
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    SymPy backend
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    SymPy backend
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#calt.dataset.sympy.dataset_generator.DatasetGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.dataset_generator.DatasetGenerator.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler" class="md-nav__link">
    <span class="md-ellipsis">
      PolynomialSampler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PolynomialSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler--behavior-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Behavior summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_field" class="md-nav__link">
    <span class="md-ellipsis">
      get_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_ring" class="md-nav__link">
    <span class="md-ellipsis">
      get_ring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.total_degree" class="md-nav__link">
    <span class="md-ellipsis">
      total_degree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2_2" id="__nav_1_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    IO pipeline
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            IO pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io_lexer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lexer and vocabulary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io_load_preprocessors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Load preprocessors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io_visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_3" >
        
          
          <label class="md-nav__link" for="__nav_1_2_3" id="__nav_1_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Trainer pipeline
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            Trainer pipeline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#calt.dataset.sympy.dataset_generator.DatasetGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.dataset_generator.DatasetGenerator.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler" class="md-nav__link">
    <span class="md-ellipsis">
      PolynomialSampler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PolynomialSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler--behavior-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Behavior summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_field" class="md-nav__link">
    <span class="md-ellipsis">
      get_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_ring" class="md-nav__link">
    <span class="md-ellipsis">
      get_ring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.total_degree" class="md-nav__link">
    <span class="md-ellipsis">
      total_degree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="sympy-backend">SymPy backend<a class="headerlink" href="#sympy-backend" title="Permanent link">&para;</a></h1>
<p>When using <code>backend="sympy"</code>, the following classes are used for generation and sampling. You can also use them directly without <a href="../dataset_generator/">DatasetPipeline</a>.</p>
<p>See <a href="../dataset_generator/">Dataset Generator (Overview)</a> for the pipeline and <code>data.yaml</code> configuration.</p>
<!-- ## DatasetGenerator -->



<div class="doc doc-object doc-class">



<h2 id="calt.dataset.sympy.dataset_generator.DatasetGenerator" class="doc doc-heading">
            DatasetGenerator


<a href="#calt.dataset.sympy.dataset_generator.DatasetGenerator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">DatasetGenerator</span><span class="p">(</span>
    <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multiprocessing&quot;</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">root_seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Base class for instance generators</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>backend</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Backend for parallel processing</p>
              </div>
            </td>
            <td>
                  <code>&#39;multiprocessing&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_jobs</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel jobs (-1 for all cores)</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to display progress information</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>root_seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Root seed for reproducibility</p>
              </div>
            </td>
            <td>
                  <code>42</code>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>src/calt/dataset/sympy/dataset_generator.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">backend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;multiprocessing&quot;</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">root_seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize instance generator.</span>

<span class="sd">    Args:</span>
<span class="sd">        backend: Backend for parallel processing</span>
<span class="sd">        n_jobs: Number of parallel jobs (-1 for all cores)</span>
<span class="sd">        verbose: Whether to display progress information</span>
<span class="sd">        root_seed: Root seed for reproducibility</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">=</span> <span class="n">backend</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root_seed</span> <span class="o">=</span> <span class="n">root_seed</span>

    <span class="c1"># Configure logging only once at initialization</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>

    <span class="c1"># Configure joblib logging to show progress but not overwhelm</span>
    <span class="c1"># Only set if not already configured</span>
    <span class="n">joblib_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;joblib&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">joblib_logger</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">joblib_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="n">parallel_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;joblib.Parallel&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">parallel_logger</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">:</span>
        <span class="n">parallel_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="calt.dataset.sympy.dataset_generator.DatasetGenerator.run" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">run</span>


<a href="#calt.dataset.sympy.dataset_generator.DatasetGenerator.run" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">run</span><span class="p">(</span>
    <span class="n">dataset_sizes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">instance_generator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">statistics_calculator</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dataset_writer</span><span class="p">:</span> <span class="n">DatasetWriter</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">save_text</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">save_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate multiple datasets using parallel processing with batch writing.</p>
<p>This is the main entry point for dataset generation. It supports generating
multiple datasets (train/test) simultaneously or separately, with efficient
memory management through batch processing and parallel execution.</p>
<p>Key features:</p>
<ul>
<li>Parallel processing using joblib for high performance</li>
<li>Batch-based memory management to handle large datasets</li>
<li>Incremental statistics calculation to avoid memory issues</li>
<li>Reproducible generation with unique seeds for each sample</li>
<li>Support for nested data structures (up to 2 levels)</li>
<li>Multiple output formats (text, JSON Lines) via DatasetWriter</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset_sizes</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping dataset names to number of samples.
          Any string can be used as dataset name (e.g., "train", "test", "validation").
          Duplicate names are not allowed.
          Example: {"train": 100000, "test": 1000} or {"train": 100000, "validation": 5000}</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instance_generator</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that generates (problem, answer) pair given a seed.
             Must accept a single integer seed parameter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistics_calculator</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional function to calculate sample-specific statistics.
                 Must accept (problem, answer) and return dict or None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_writer</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DatasetWriter (calt.dataset.utils.dataset_writer.DatasetWriter)" href="../dataset_generator/#calt.dataset.utils.dataset_writer.DatasetWriter">DatasetWriter</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DatasetWriter object for saving datasets to files.
          If None, a new DatasetWriter will be created using save_dir, save_text, and save_json parameters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to process in each batch. Larger batches
       use more memory but may be more efficient for I/O operations.</p>
              </div>
            </td>
            <td>
                  <code>100000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base directory for saving datasets. Used only if dataset_writer is None.
     If None, uses current working directory.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_text</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to save raw text files. Used only if dataset_writer is None.
      Text files use "#" as separator between problem and answer.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_json</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to save JSON Lines files. Used only if dataset_writer is None.
      JSON Lines files preserve the original nested structure format.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If dataset_sizes is invalid or instance_generator is None</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If parallel processing fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>Each sample gets a unique seed for reproducibility</li>
<li>Progress is logged if verbose=True (set in <strong>init</strong>)</li>
<li>Memory usage scales with batch_size, not total dataset size</li>
<li>Statistics are calculated incrementally to handle large datasets</li>
<li>If dataset_writer is provided, save_dir, save_text, and save_json parameters are ignored</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define instance generator function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">instance_generator</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
<span class="gp">... </span>    <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="gp">... </span>    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c1"># Generate random polynomial problem</span>
<span class="gp">... </span>    <span class="n">problem</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))]</span>
<span class="gp">... </span>    <span class="n">answer</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">problem</span><span class="p">,</span> <span class="n">answer</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialize dataset generator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">DatasetGenerator</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Method 1: Automatic DatasetWriter creation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dataset_sizes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">instance_generator</span><span class="o">=</span><span class="n">instance_generator</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_dir</span><span class="o">=</span><span class="s2">&quot;./datasets&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_json</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Method 2: Manual DatasetWriter creation (for advanced use cases)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">calt.dataset.sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetWriter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">DatasetWriter</span><span class="p">(</span><span class="n">save_dir</span><span class="o">=</span><span class="s2">&quot;./datasets&quot;</span><span class="p">,</span> <span class="n">save_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_json</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dataset_sizes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">instance_generator</span><span class="o">=</span><span class="n">instance_generator</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dataset_writer</span><span class="o">=</span><span class="n">writer</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Method 3: Generate datasets separately (if needed)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dataset_sizes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">instance_generator</span><span class="o">=</span><span class="n">instance_generator</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_dir</span><span class="o">=</span><span class="s2">&quot;./datasets&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dataset_sizes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;validation&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">instance_generator</span><span class="o">=</span><span class="n">instance_generator</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_dir</span><span class="o">=</span><span class="s2">&quot;./datasets&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/calt/dataset/sympy/dataset_generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset_sizes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">instance_generator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">statistics_calculator</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dataset_writer</span><span class="p">:</span> <span class="n">DatasetWriter</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>
    <span class="n">save_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">save_text</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">save_json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate multiple datasets using parallel processing with batch writing.</span>

<span class="sd">    This is the main entry point for dataset generation. It supports generating</span>
<span class="sd">    multiple datasets (train/test) simultaneously or separately, with efficient</span>
<span class="sd">    memory management through batch processing and parallel execution.</span>

<span class="sd">    Key features:</span>

<span class="sd">    - Parallel processing using joblib for high performance</span>
<span class="sd">    - Batch-based memory management to handle large datasets</span>
<span class="sd">    - Incremental statistics calculation to avoid memory issues</span>
<span class="sd">    - Reproducible generation with unique seeds for each sample</span>
<span class="sd">    - Support for nested data structures (up to 2 levels)</span>
<span class="sd">    - Multiple output formats (text, JSON Lines) via DatasetWriter</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset_sizes: Dictionary mapping dataset names to number of samples.</span>
<span class="sd">                      Any string can be used as dataset name (e.g., &quot;train&quot;, &quot;test&quot;, &quot;validation&quot;).</span>
<span class="sd">                      Duplicate names are not allowed.</span>
<span class="sd">                      Example: {&quot;train&quot;: 100000, &quot;test&quot;: 1000} or {&quot;train&quot;: 100000, &quot;validation&quot;: 5000}</span>
<span class="sd">        instance_generator: Function that generates (problem, answer) pair given a seed.</span>
<span class="sd">                         Must accept a single integer seed parameter.</span>
<span class="sd">        statistics_calculator: Optional function to calculate sample-specific statistics.</span>
<span class="sd">                             Must accept (problem, answer) and return dict or None.</span>
<span class="sd">        dataset_writer: DatasetWriter object for saving datasets to files.</span>
<span class="sd">                      If None, a new DatasetWriter will be created using save_dir, save_text, and save_json parameters.</span>
<span class="sd">        batch_size: Number of samples to process in each batch. Larger batches</span>
<span class="sd">                   use more memory but may be more efficient for I/O operations.</span>
<span class="sd">        save_dir: Base directory for saving datasets. Used only if dataset_writer is None.</span>
<span class="sd">                 If None, uses current working directory.</span>
<span class="sd">        save_text: Whether to save raw text files. Used only if dataset_writer is None.</span>
<span class="sd">                  Text files use &quot;#&quot; as separator between problem and answer.</span>
<span class="sd">        save_json: Whether to save JSON Lines files. Used only if dataset_writer is None.</span>
<span class="sd">                  JSON Lines files preserve the original nested structure format.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If dataset_sizes is invalid or instance_generator is None</span>
<span class="sd">        Exception: If parallel processing fails</span>

<span class="sd">    Note:</span>
<span class="sd">        - Each sample gets a unique seed for reproducibility</span>
<span class="sd">        - Progress is logged if verbose=True (set in __init__)</span>
<span class="sd">        - Memory usage scales with batch_size, not total dataset size</span>
<span class="sd">        - Statistics are calculated incrementally to handle large datasets</span>
<span class="sd">        - If dataset_writer is provided, save_dir, save_text, and save_json parameters are ignored</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; # Define instance generator function</span>
<span class="sd">        &gt;&gt;&gt; def instance_generator(seed):</span>
<span class="sd">        ...     import random</span>
<span class="sd">        ...     random.seed(seed)</span>
<span class="sd">        ...     # Generate random polynomial problem</span>
<span class="sd">        ...     problem = [random.randint(1, 1000) for _ in range(random.randint(1, 10))]</span>
<span class="sd">        ...     answer = sum(problem)</span>
<span class="sd">        ...     return problem, answer</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Initialize dataset generator</span>
<span class="sd">        &gt;&gt;&gt; generator = DatasetGenerator(n_jobs=-1, verbose=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Method 1: Automatic DatasetWriter creation</span>
<span class="sd">        &gt;&gt;&gt; generator.run(</span>
<span class="sd">        ...     dataset_sizes={&quot;train&quot;: 10000, &quot;test&quot;: 1000, &quot;validation&quot;: 500},</span>
<span class="sd">        ...     instance_generator=instance_generator,</span>
<span class="sd">        ...     save_dir=&quot;./datasets&quot;,</span>
<span class="sd">        ...     save_text=True,</span>
<span class="sd">        ...     save_json=True,</span>
<span class="sd">        ...     batch_size=100</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Method 2: Manual DatasetWriter creation (for advanced use cases)</span>
<span class="sd">        &gt;&gt;&gt; from calt.dataset.sympy import DatasetWriter</span>
<span class="sd">        &gt;&gt;&gt; writer = DatasetWriter(save_dir=&quot;./datasets&quot;, save_text=True, save_json=True)</span>
<span class="sd">        &gt;&gt;&gt; generator.run(</span>
<span class="sd">        ...     dataset_sizes={&quot;train&quot;: 10000, &quot;test&quot;: 1000},</span>
<span class="sd">        ...     instance_generator=instance_generator,</span>
<span class="sd">        ...     dataset_writer=writer,</span>
<span class="sd">        ...     batch_size=100</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Method 3: Generate datasets separately (if needed)</span>
<span class="sd">        &gt;&gt;&gt; generator.run(</span>
<span class="sd">        ...     dataset_sizes={&quot;train&quot;: 10000},</span>
<span class="sd">        ...     instance_generator=instance_generator,</span>
<span class="sd">        ...     save_dir=&quot;./datasets&quot;,</span>
<span class="sd">        ...     batch_size=100</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; generator.run(</span>
<span class="sd">        ...     dataset_sizes={&quot;test&quot;: 1000, &quot;validation&quot;: 500},</span>
<span class="sd">        ...     instance_generator=instance_generator,</span>
<span class="sd">        ...     save_dir=&quot;./datasets&quot;,</span>
<span class="sd">        ...     batch_size=100</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create DatasetWriter if not provided</span>
    <span class="k">if</span> <span class="n">dataset_writer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dataset_writer</span> <span class="o">=</span> <span class="n">DatasetWriter</span><span class="p">(</span>
            <span class="n">save_dir</span><span class="o">=</span><span class="n">save_dir</span><span class="p">,</span>
            <span class="n">save_text</span><span class="o">=</span><span class="n">save_text</span><span class="p">,</span>
            <span class="n">save_json</span><span class="o">=</span><span class="n">save_json</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;save_dir: </span><span class="si">{</span><span class="n">dataset_writer</span><span class="o">.</span><span class="n">save_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Text output: </span><span class="si">{</span><span class="n">save_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;JSON output: </span><span class="si">{</span><span class="n">save_json</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Prepare common arguments</span>
    <span class="n">common_args</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;instance_generator&quot;</span><span class="p">:</span> <span class="n">instance_generator</span><span class="p">,</span>
        <span class="s2">&quot;statistics_calculator&quot;</span><span class="p">:</span> <span class="n">statistics_calculator</span><span class="p">,</span>
        <span class="s2">&quot;dataset_writer&quot;</span><span class="p">:</span> <span class="n">dataset_writer</span><span class="p">,</span>
        <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">batch_size</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Validate dataset_sizes</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset_sizes</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dataset_sizes must be a dictionary&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">dataset_sizes</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dataset_sizes cannot be empty&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">instance_generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;instance_generator must be provided&quot;</span><span class="p">)</span>

    <span class="c1"># Check for duplicate dataset names</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_sizes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dataset_sizes</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Duplicate dataset names are not allowed&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">num_samples</span> <span class="ow">in</span> <span class="n">dataset_sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">num_samples</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Number of samples must be a positive integer, got </span><span class="si">{</span><span class="n">num_samples</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">dataset_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Log overall generation start</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;=========================== Dataset generation ===========================</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Starting dataset generation for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset_sizes</span><span class="p">)</span><span class="si">}</span><span class="s2"> dataset(s)&quot;</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset sizes: </span><span class="si">{</span><span class="n">dataset_sizes</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Generate each dataset</span>
    <span class="k">for</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">num_samples</span> <span class="ow">in</span> <span class="n">dataset_sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_dataset</span><span class="p">(</span>
            <span class="n">tag</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="n">num_samples</span><span class="p">,</span> <span class="o">**</span><span class="n">common_args</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All datasets generated successfully!&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;==========================================================================</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><!-- ## Sampling -->



<div class="doc doc-object doc-class">



<h2 id="calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler" class="doc doc-heading">
            PolynomialSampler


<a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">PolynomialSampler</span><span class="p">(</span>
    <span class="n">symbols</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">field_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">MonomialOrder</span> <span class="o">=</span> <span class="s2">&quot;grevlex&quot;</span><span class="p">,</span>
    <span class="n">max_num_terms</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">max_degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">min_degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">degree_sampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
    <span class="n">term_sampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
    <span class="n">max_coeff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_bound</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">strictly_conditioned</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">nonzero_instance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">max_attempts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">


        <p>Generator for random polynomials with specific constraints (SymPy).</p>
<p>The sampler builds polynomials by choosing a target degree and number
of terms (within min/max bounds), then uses :class:<code>SinglePolynomialSampler</code>
to select that many distinct monomials and assign random coefficients
from the base ring. Ring is specified by symbols, field_str, and order.</p>
<h4 id="calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler--behavior-summary">Behavior summary<a class="headerlink" href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler--behavior-summary" title="Permanent link">&para;</a></h4>
<p><strong>degree_sampling</strong> controls how monomial degrees are chosen (passed
as <code>choose_degree</code> to the internal sampler):</p>
<ul>
<li><code>'uniform'</code>: For each term, a degree in [min_degree, max_degree]
  is chosen uniformly at random, then a monomial of that degree is
  chosen. The resulting polynomial's degree distribution is more
  uniform over the range.</li>
<li><code>'fixed'</code>: Monomials are chosen uniformly from all monomials of
  degree at most max_degree. The polynomial tends to have total degree
  equal to max_degree.</li>
</ul>
<p><strong>Degree and number of terms</strong>: Every returned polynomial has total
degree &gt;= min_degree. The guarantees on total degree and number of
terms depend on <code>strictly_conditioned</code> and <code>nonzero_instance</code>;
see the constructor parameters for details.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>symbols</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variable names for the polynomial ring.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>field_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base ring specifier: "QQ", "RR", "ZZ", or "GF(p)"
for a prime finite field.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="sympy.polys.orderings.MonomialOrder">MonomialOrder</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Term order of the ring, e.g. "grevlex".</p>
              </div>
            </td>
            <td>
                  <code>&#39;grevlex&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_num_terms</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound on number of terms. If None, all
monomials of the chosen degree are allowed.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_degree</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum total degree of the polynomial.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_degree</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum total degree; every returned polynomial
has total degree &gt;= min_degree.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_coeff</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bound on coefficient absolute value for RR and ZZ.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_bound</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bound on numerator/denominator absolute value
for QQ.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>degree_sampling</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>'uniform'</code> or <code>'fixed'</code>; see class
docstring (Behavior summary).</p>
              </div>
            </td>
            <td>
                  <code>&#39;uniform&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>term_sampling</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>'uniform'</code>: number of terms chosen uniformly
in [1, max_terms] (max_terms bounded by max_num_terms);
<code>'fixed'</code>: use max_terms.</p>
              </div>
            </td>
            <td>
                  <code>&#39;uniform&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strictly_conditioned</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Controls when a generated polynomial
is accepted.</p>
<ul>
<li>If True:<ul>
<li>Return only when total degree equals the degree
  selected for this sample and number of terms
  equals the number of terms selected for this
  sample. (Those values are chosen by
  degree_sampling and term_sampling; degree is in
  [min_degree, max_degree], and number of terms is
  at most max_num_terms.)</li>
<li>RuntimeError is raised if no success within
  max_attempts.</li>
</ul>
</li>
<li>If False:<ul>
<li>Return the first polynomial with total degree &gt;=
  min_degree and (if nonzero_instance) non-zero.</li>
<li>Number of terms may be less than the chosen value
  when nonzero_instance is False.</li>
</ul>
</li>
</ul>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nonzero_instance</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the zero polynomial is never
returned and all coefficients are non-zero (predictable
number of terms). If False, coefficients may be zero.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_attempts</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum trials per polynomial when
strictly_conditioned is True; RuntimeError is raised if
no success.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>src/calt/dataset/sympy/utils/polynomial_sampler.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">symbols</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">field_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">MonomialOrder</span> <span class="o">=</span> <span class="s2">&quot;grevlex&quot;</span><span class="p">,</span>
    <span class="n">max_num_terms</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">max_degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">min_degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">degree_sampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>  <span class="c1"># &#39;uniform&#39; or &#39;fixed&#39;</span>
    <span class="n">term_sampling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>  <span class="c1"># &#39;uniform&#39; or &#39;fixed&#39;</span>
    <span class="n">max_coeff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Used for RR and ZZ</span>
    <span class="n">num_bound</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># Used for QQ</span>
    <span class="n">strictly_conditioned</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">nonzero_instance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">max_attempts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize polynomial sampler.</span>

<span class="sd">    Args:</span>
<span class="sd">        symbols: Variable names for the polynomial ring.</span>
<span class="sd">        field_str: Base ring specifier: &quot;QQ&quot;, &quot;RR&quot;, &quot;ZZ&quot;, or &quot;GF(p)&quot;</span>
<span class="sd">            for a prime finite field.</span>
<span class="sd">        order: Term order of the ring, e.g. &quot;grevlex&quot;.</span>
<span class="sd">        max_num_terms: Upper bound on number of terms. If None, all</span>
<span class="sd">            monomials of the chosen degree are allowed.</span>
<span class="sd">        max_degree: Maximum total degree of the polynomial.</span>
<span class="sd">        min_degree: Minimum total degree; every returned polynomial</span>
<span class="sd">            has total degree &gt;= min_degree.</span>
<span class="sd">        max_coeff: Bound on coefficient absolute value for RR and ZZ.</span>
<span class="sd">        num_bound: Bound on numerator/denominator absolute value</span>
<span class="sd">            for QQ.</span>
<span class="sd">        degree_sampling: ``&#39;uniform&#39;`` or ``&#39;fixed&#39;``; see class</span>
<span class="sd">            docstring (Behavior summary).</span>
<span class="sd">        term_sampling: ``&#39;uniform&#39;``: number of terms chosen uniformly</span>
<span class="sd">            in [1, max_terms] (max_terms bounded by max_num_terms);</span>
<span class="sd">            ``&#39;fixed&#39;``: use max_terms.</span>
<span class="sd">        strictly_conditioned: Controls when a generated polynomial</span>
<span class="sd">            is accepted.</span>

<span class="sd">            - If True:</span>
<span class="sd">                - Return only when total degree equals the degree</span>
<span class="sd">                  selected for this sample and number of terms</span>
<span class="sd">                  equals the number of terms selected for this</span>
<span class="sd">                  sample. (Those values are chosen by</span>
<span class="sd">                  degree_sampling and term_sampling; degree is in</span>
<span class="sd">                  [min_degree, max_degree], and number of terms is</span>
<span class="sd">                  at most max_num_terms.)</span>
<span class="sd">                - RuntimeError is raised if no success within</span>
<span class="sd">                  max_attempts.</span>
<span class="sd">            - If False:</span>
<span class="sd">                - Return the first polynomial with total degree &gt;=</span>
<span class="sd">                  min_degree and (if nonzero_instance) non-zero.</span>
<span class="sd">                - Number of terms may be less than the chosen value</span>
<span class="sd">                  when nonzero_instance is False.</span>
<span class="sd">        nonzero_instance: If True, the zero polynomial is never</span>
<span class="sd">            returned and all coefficients are non-zero (predictable</span>
<span class="sd">            number of terms). If False, coefficients may be zero.</span>
<span class="sd">        max_attempts: Maximum trials per polynomial when</span>
<span class="sd">            strictly_conditioned is True; RuntimeError is raised if</span>
<span class="sd">            no success.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">symbols</span> <span class="o">=</span> <span class="n">symbols</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">field_str</span> <span class="o">=</span> <span class="n">field_str</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_num_terms</span> <span class="o">=</span> <span class="n">max_num_terms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_degree</span> <span class="o">=</span> <span class="n">max_degree</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_degree</span> <span class="o">=</span> <span class="n">min_degree</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_coeff</span> <span class="o">=</span> <span class="n">max_coeff</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_bound</span> <span class="o">=</span> <span class="n">num_bound</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">degree_sampling</span> <span class="o">=</span> <span class="n">degree_sampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">term_sampling</span> <span class="o">=</span> <span class="n">term_sampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strictly_conditioned</span> <span class="o">=</span> <span class="n">strictly_conditioned</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nonzero_instance</span> <span class="o">=</span> <span class="n">nonzero_instance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_attempts</span> <span class="o">=</span> <span class="n">max_attempts</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">single_poly_sampler</span> <span class="o">=</span> <span class="n">SinglePolynomialSampler</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_field" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_field</span>


<a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_field" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_field</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Domain</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the SymPy domain for field_str (QQ, RR, ZZ, or GF(p)).</p>


            <details class="quote">
              <summary>Source code in <code>src/calt/dataset/sympy/utils/polynomial_sampler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_field</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Domain</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the SymPy domain for field_str (QQ, RR, ZZ, or GF(p)).&quot;&quot;&quot;</span>
    <span class="c1"># Standard field mapping</span>
    <span class="n">standard_fields</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;QQ&quot;</span><span class="p">:</span> <span class="n">QQ</span><span class="p">,</span> <span class="s2">&quot;RR&quot;</span><span class="p">:</span> <span class="n">RR</span><span class="p">,</span> <span class="s2">&quot;ZZ&quot;</span><span class="p">:</span> <span class="n">ZZ</span><span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_str</span> <span class="ow">in</span> <span class="n">standard_fields</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">standard_fields</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">field_str</span><span class="p">]</span>

    <span class="c1"># Finite field handling</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;GF&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported field: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">field_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Extract field size based on format</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">field_str</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;GF(&quot;</span><span class="p">)</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_str</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Field size must be greater than 1: </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">GF</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported field: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">field_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_ring" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_ring</span>


<a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.get_ring" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_ring</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">PolyRing</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the polynomial ring (PolyRing) for the configured symbols, field, and order.</p>


            <details class="quote">
              <summary>Source code in <code>src/calt/dataset/sympy/utils/polynomial_sampler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_ring</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PolyRing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the polynomial ring (PolyRing) for the configured symbols, field, and order.&quot;&quot;&quot;</span>

    <span class="n">R</span><span class="p">,</span> <span class="o">*</span><span class="n">gens</span> <span class="o">=</span> <span class="n">ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_field</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">R</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.sample" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">sample</span>


<a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.sample" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sample</span><span class="p">(</span>
    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">matrix_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PolyElement</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate random polynomial samples</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_samples</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to generate</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, generate matrix of polynomials with given size</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>density</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Probability of non-zero entries in matrix</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>matrix_type</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Special matrix type (e.g., 'unimodular_upper_triangular')</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="sympy.polys.rings.PolyElement">PolyElement</span>] | <span title="list">list</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of polynomials, or list of polynomial matrices when</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="sympy.polys.rings.PolyElement">PolyElement</span>] | <span title="list">list</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>size is provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/calt/dataset/sympy/utils/polynomial_sampler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">matrix_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PolyElement</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate random polynomial samples</span>

<span class="sd">    Args:</span>
<span class="sd">        num_samples: Number of samples to generate</span>
<span class="sd">        size: If provided, generate matrix of polynomials with given size</span>
<span class="sd">        density: Probability of non-zero entries in matrix</span>
<span class="sd">        matrix_type: Special matrix type (e.g., &#39;unimodular_upper_triangular&#39;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of polynomials, or list of polynomial matrices when</span>
<span class="sd">        size is provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_matrix</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_sample_polynomial</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.total_degree" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">total_degree</span>


<a href="#calt.dataset.sympy.utils.polynomial_sampler.PolynomialSampler.total_degree" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">total_degree</span><span class="p">(</span><span class="n">poly</span><span class="p">:</span> <span class="n">PolyElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return the total degree of the polynomial.</p>


            <details class="quote">
              <summary>Source code in <code>src/calt/dataset/sympy/utils/polynomial_sampler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">total_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">:</span> <span class="n">PolyElement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the total degree of the polynomial.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">poly</span><span class="o">.</span><span class="n">is_zero</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">monom</span><span class="p">)</span> <span class="k">for</span> <span class="n">monom</span> <span class="ow">in</span> <span class="n">poly</span><span class="o">.</span><span class="n">monoms</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.top", "search.highlight", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>